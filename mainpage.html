<!DOCTYPE html>
<html lang="nl">
<head>
  <head>
  <meta charset="UTF-8">
  <title>Logbook Webdeveloper</title>
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Almendra+SC&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="mainpage.css">
</head>
  <meta charset="UTF-8">
  <title>Logbook Webdeveloper</title>
  <link rel="stylesheet" href="mainpage.css">
  <script src="page-loader.js" defer></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Dancing+Script:wght@500;700&family=Roboto:wght@300;400&display=swap" rel="stylesheet">
</head>

<body>
  <header class="page-header">
    <h1 class="title">Lost in tra(i)nslation </h1>
    <p> E v e l y n w e l t e </p>
    <p> 1GDM1 </p>
    <div class="header-line"></div>
  </header>

  <main class="week-center">
    <a class="week-link" href="week1.html">STATION 1</a>
    <a class="week-link" href="week2.html">STATION 2</a>
    <a class="week-link" href="week3.html">STATION 3</a>
    <a class="week-link" href="week4.html">STATION 4</a>
    <a class="week-link" href="week5.html">STATION 5</a>
    <a class="week-link" href="week6.html">STATION 6</a>
    <a class="week-link" href="week7.html">STATION 7</a>
    <a class="week-link" href="week8.html">STATION 8</a>
    <a class="week-link" href="week9.html">STATION 9</a>
  </main>

  <div id="trainArea" aria-hidden="true">
    <img id="train" src="TRAIN.jpg" alt="train">
  </div>

  <!-- âœ… JS must be HERE, before </body> -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const links = document.querySelectorAll(".week-link");
  const trainArea = document.getElementById("trainArea");
  const train = document.getElementById("train");

  let busy = false;

  function resetTrain() {
    if (!train) return;
    train.style.transition = "none";
    train.style.transform = "translateX(0px)";
    train.getBoundingClientRect(); // force reflow
  }

  function animateBottomTrain(durationMs = 2000) {
    return new Promise((resolve) => {
      if (!train || !trainArea) return resolve();

      resetTrain();

      const maxX = Math.max(0, trainArea.clientWidth - train.offsetWidth);
      train.style.transition = `transform ${durationMs}ms ease`;

      // fallback (in case transitionend doesn't fire)
      const fallback = setTimeout(resolve, durationMs + 80);

      const done = (ev) => {
        if (ev.propertyName !== "transform" && ev.propertyName !== "webkitTransform") return;
        clearTimeout(fallback);
        resolve();
      };

      train.addEventListener("transitionend", done, { once: true });

      requestAnimationFrame(() => {
        train.style.transform = `translateX(${maxX}px)`;
      });
    });
  }

  function showTrainLoader(durationMs = 2000) {
    return new Promise((resolve) => {
      let box = document.getElementById("miniTrainLoader");

      if (!box) {
        box = document.createElement("div");
        box.id = "miniTrainLoader";
        box.style.cssText = `
          position: fixed;
          left: 50%; top: 50%;
          transform: translate(-50%, -50%);
          z-index: 999999;
          background: rgba(255,255,255,0.95);
          border: 1px solid rgba(0,0,0,0.12);
          border-radius: 14px;
          padding: 16px 18px;
          display: none;
          pointer-events: none;
          text-align: center;
          box-shadow: 0 10px 30px rgba(0,0,0,0.12);
        `;

        const img = document.createElement("img");
        img.id = "miniTrainLoaderImg";
        img.alt = "Loading train";
        img.style.cssText = `
          width: 220px;
          max-width: 70vw;
          height: auto;
          display: block;
          margin: 0 auto;
        `;

        const txt = document.createElement("div");
        txt.textContent = "LOGBOOK...";
        txt.style.cssText = `
          margin-top: 10px;
          font-family: Arial, sans-serif;
          opacity: .7;
        `;

        box.appendChild(img);
        box.appendChild(txt);
        document.body.appendChild(box);
      }

      const img = document.getElementById("miniTrainLoaderImg");
      img.src = train?.src || "./ChatGPT Image 14 Ara 2025 15_02_57.png.jpg";

      box.style.display = "block";

      img.animate(
        [
          { transform: "translateX(-10px)" },
          { transform: "translateX(10px)" },
          { transform: "translateX(-10px)" }
        ],
        { duration: 500, iterations: Math.ceil(durationMs / 500) }
      );

      setTimeout(() => {
        box.style.display = "none";
        resolve();
      }, durationMs);
    });
  }

  links.forEach((link) => {
    link.addEventListener("click", async (e) => {
      e.preventDefault();
      if (busy) return;
      busy = true;

      const targetHref = link.getAttribute("href");

      await animateBottomTrain(2000);   // 1) train moves first (2s)
      await showTrainLoader(900);      // 2) then loader (2s)
      window.location.href = targetHref; // 3) go page
    });
  });

  window.addEventListener("pageshow", () => {
    busy = false;
    resetTrain();
  });
});
   
</script>